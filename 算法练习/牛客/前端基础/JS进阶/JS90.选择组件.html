<!--
@nc app=nowcoder id=ed0bd346dc9c4184aacda183484a3a6f topic=271 question=39639 lang=Html
2024-06-11 16:56:52
https://www.nowcoder.com/practice/ed0bd346dc9c4184aacda183484a3a6f?tpId=271&tqId=39639
[JS90] 选择组件
-->

<!--@nc code=start-->

<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
       .checkgroup .item{
    height: 42px;
    line-height: 42px;
    padding: 0 10px;
    margin: 10px 0;
    border: 1px solid #c7c7c7;
    border-radius: 6px;
}
.checkgroup.radius .item{
    border-radius: 21px;
}
.checkgroup .item.selected{
    border: 1px solid #08b292;
    background: #08b292;
    color: #ffffff;
}
    </style>
</head>

<body>
    <div id="jsCheckGroup">
    <div class="checkgroup radius">
        <div data-val="a" class="item selected">选项a</div>
        <div data-val="b" class="item">选项b</div>
        <div data-val="c" class="item">选项c</div>
        <div data-val="d" class="item">选项d</div>
    </div>
</div>
    <script type="text/javascript">
function CheckGroup(renderTo, options, isMultiple) {
    var that = this;
    that.renderTo = renderTo;
    that.options = options;
    that.isMultiple = !!isMultiple;
    that.initHtml();
    that.initEvent();
}
CheckGroup.prototype.initHtml = fInitHtml;
CheckGroup.prototype.initEvent = fInitEvent;
CheckGroup.prototype.toggleEl = fToggleEl;
CheckGroup.prototype.isSelected = fIsSelected;
CheckGroup.prototype.val = fVal;

function fInitHtml() {
    var that = this;
    // 请补全代码，拼接html字符串
    var sHtml = `<div class="checkgroup${!that.isMultiple ? ' radius' : ''}">` + that.options.map(item => `<div data-val="${item.value}" class="item">${item.text}</div>`).join('') + '</div>'
    that.renderTo.innerHTML = sHtml;
    // 请补全代码，获取checkgroup的dom元素引用
    that.el = document.querySelector('.checkgroup');
}

function fInitEvent() {
    var that = this;
    that.el && that.el.addEventListener('click', function (event) {
        var item = event.target;
        item.classList.contains('item') && that.toggleEl(item);
    });
}

function fToggleEl(item) {
    // 根据当前是单选还是多选，以及当前元素是否选中，高亮/取消���亮指定的选项dom元素
    var that = this;
    if (that.isSelected(item)) {
        // 请补全代码
        item.classList.remove('selected')
    } else if (that.isMultiple) {
        // 请补全代码
        item.classList.add('selected')
    } else {
        // 请补全代码
        Array.from(that.el.children).forEach(each => { each.classList.remove('selected') })
        item.classList.add('selected')
    }
}

function fIsSelected(item) {
    // 请补全代码，判断item是否选中
    return Array.from(item.classList).includes('selected')
    // return item;
}

function fVal(values) {
    var that = this;
    if (arguments.length === 0) {
        // 请补全代码，获取高亮的选项元素
        var items = Array.from(document.querySelectorAll('.item'));
        // 请补全代码，获取高亮的选项元素的data-val
        var result = items.filter(each => fIsSelected(each)).map(each => each.getAttribute('data-val'));
        return result;
    }
    !that.isMultiple && values.length > 1 && (values.length = 1);
    // 请补全代码，获取所有的选项元素
    var items = Array.from(document.querySelectorAll('.item'));
    // 请补全代码，在指定元素上加上高亮的class
    items.forEach(item => {
        if (values.includes(item.getAttribute('data-val'))) {
            item.classList.add('selected')
        } else {
            item.classList.remove('selected')
        }
    })
}
    </script>
</body>

</html>

<!--@nc code=end-->
